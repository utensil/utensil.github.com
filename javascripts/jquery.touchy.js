!function(t){t.touchyOptions={useDelegation:!1,longpress:{preventDefault:{start:!0,move:!0,end:!0},requiredTouches:1,msThresh:800,triggerStartPhase:!1,data:{startDate:null},proxyEvents:["TouchStart","TouchEnd"]},drag:{preventDefault:{start:!0,move:!0,end:!0},requiredTouches:1,msHoldThresh:100,data:{startPoint:null,startDate:null,movePoint:null,moveDate:null,held:!1},proxyEvents:["TouchStart","TouchMove","TouchEnd"]},pinch:{preventDefault:{start:!0,move:!0,end:!0},requiredTouches:2,pxThresh:0,data:{startPoint:null,startDate:null,movePoint:null,moveDate:null},proxyEvents:["TouchStart","TouchMove","GestureChange","TouchEnd"]},rotate:{preventDefault:{start:!0,move:!0,end:!0},requiredTouches:1,data:{},proxyEvents:["TouchStart","TouchMove","GestureChange","TouchEnd"]},swipe:{preventDefault:{start:!0,move:!0,end:!0},requiredTouches:1,velocityThresh:1,triggerOn:"touchmove",data:{startPoint:null,startDate:null,movePoint:null,moveDate:null},proxyEvents:["TouchStart","TouchMove","TouchEnd"]}};var e={handleTouchStart:function(e){var r=this.context,s=l(e,r);if(s){var c=e.originalEvent,u=c.targetTouches,v="touchy"+r.charAt(0).toUpperCase()+r.slice(1),h=s.data(v),d=h.settings;if(d.preventDefault.start&&c.preventDefault(),u.length===d.requiredTouches)switch(r){case"drag":a(h,u,e.timeStamp);var p=h.startPoint;s.trigger("touchy-drag",["start",s,{movePoint:p,lastMovePoint:p,startPoint:p,velocity:0}]);break;case"swipe":o(h,u,e.timeStamp);break;case"pinch":var g=i(e);g&&(h.startPoint={x:g.centerX,y:g.centerY},h.startDistance=Math.sqrt(Math.pow(g.x2-g.x1,2)+Math.pow(g.y2-g.y1,2)));break;case"longpress":h.startPoint={x:u[0].pageX,y:u[0].pageY},h.startDate=e.timeStamp,d.triggerStartPhase&&s.trigger("touchy-longpress",["start",s]),h.timer=setTimeout(t.proxy(function(){s.trigger("touchy-longpress",["end",s])},this),d.msThresh);break;case"rotate":if(1===u.length)n(h,u,e.timeStamp);else{var g=i(e);h.startPoint={x:g.centerX,y:g.centerY},h.startDate=e.timeStamp}var p=h.startPoint;s.trigger("touchy-rotate",["start",s,{startPoint:p,movePoint:p,lastMovePoint:p,velocity:0,degrees:0}])}}},handleTouchMove:function(t){var e=this.context,n=l(t,e);if(n){var u=t.originalEvent,v=u.targetTouches,h="touchy"+e.charAt(0).toUpperCase()+e.slice(1),d=n.data(h),p=d.settings;if(p.preventDefault.move&&u.preventDefault(),v.length===p.requiredTouches)switch(e){case"drag":a(d,v,t.timeStamp);var g=d.movePoint,y=d.lastMovePoint,m=g.x===y.x&&g.y===y.y?0:Math.sqrt(Math.pow(g.x-y.x,2)+Math.pow(g.y-y.y,2)),P=d.moveDate-d.lastMoveDate,D=0===P?0:m/P;d.held&&n.trigger("touchy-drag",["move",n,{movePoint:g,lastMovePoint:y,startPoint:d.startPoint,velocity:D}]);break;case"swipe":o(d,v,t.timeStamp),!d.swipeExecuted&&d.swiped&&"touchmove"===p.triggerOn&&(d.swipeExecuted=!0,r(d,n));break;case"pinch":var f=i(t);if(f&&(d.currentPoint={x:f.centerX,y:f.centerY},!s())){var x=Math.sqrt(Math.pow(f.x2-f.x1,2)+Math.pow(f.y2-f.y1,2)),M=d.previousScale=d.scale||1,T=d.startDistance,w=d.scale=x/T,b=w*T;b>p.pxThresh&&n.trigger("touchy-pinch",[n,{scale:w,previousScale:M,currentPoint:d.currentPoint,startPoint:d.startPoint,startDistance:T}])}break;case"rotate":var y,S,g,C,S,m,P,D,E,Y,k,L,I,O;if(y=d.lastMovePoint=d.movePoint||d.startPoint,S=d.lastMoveDate=d.moveDate||d.startDate,g=d.movePoint={x:v[0].pageX,y:v[0].pageY},C=d.moveDate=t.timeStamp,1===v.length)E=d.targetPageCoords=d.targetPageCoords||c(t.target),Y=d.centerCoords=d.centerCoords||{x:E.x+.5*n.width(),y:E.y+.5*n.height()};else{var f=i(t);if(Y=d.centerCoords={x:f.centerX,y:f.centerY},s())break}k=Math.atan2(g.y-Y.y,g.x-Y.x),I=d.lastDegrees=d.degrees,L=d.degrees=k*(180/Math.PI),O=I?L-I:0,P=C-S,D=d.velocity=0===P?0:O/P,n.trigger("touchy-rotate",["move",n,{startPoint:d.startPoint,startDate:d.startDate,movePoint:g,lastMovePoint:y,centerCoords:Y,degrees:L,degreeDelta:O,velocity:D}])}}},handleGestureChange:function(e){var a=this.context,o=l(e,a);if(o){var o=t(e.target),r=e.originalEvent,n=(r.touches,"touchy"+a.charAt(0).toUpperCase()+a.slice(1)),s=o.data(n);switch(s.preventDefault.move&&r.preventDefault(),a){case"pinch":var i=s.previousScale=s.scale||1,c=s.scale=r.scale,u=s.startPoint,v=s.currentPoint||u,h=s.startDistance,d=c*h;d>s.settings.pxThresh&&o.trigger("touchy-pinch",[o,{scale:c,previousScale:i,currentPoint:v,startPoint:u,startDistance:h}]);break;case"rotate":var p=s.lastDegrees=s.degrees,g=s.degrees=r.rotation,y=p?g-p:0,m=s.moveDate-s.lastMoveDate,P=s.velocity=0===m?0:y/m;o.trigger("touchy-rotate",["move",o,{startPoint:s.startPoint,startDate:s.startDate,movePoint:s.movePoint,lastMovePoint:s.lastMovePoint,centerCoords:s.centerCoords,degrees:g,degreeDelta:y,velocity:P}])}}},handleTouchEnd:function(e){var a=this.context,o=l(e,a);if(o){var n=e.originalEvent,s="touchy"+a.charAt(0).toUpperCase()+a.slice(1),i=o.data(s),c=i.settings;switch(c.preventDefault.end&&n.preventDefault(),a){case"drag":if(i.held){var u=i.movePoint||i.startPoint,v=i.lastMovePoint||i.startPoint,h=u.x===v.x&&u.y===v.y?0:Math.sqrt(Math.pow(u.x-v.x,2)+Math.pow(u.y-v.y,2)),d=i.moveDate-i.lastMoveDate,p=0===d?0:h/d;o.trigger("touchy-drag",["end",o,{movePoint:u,lastMovePoint:v,startPoint:i.startPoint,velocity:p}])}t.extend(i,{startPoint:null,startDate:null,movePoint:null,moveDate:null,lastMovePoint:null,lastMoveDate:null,held:!1});break;case"swipe":i.swiped&&"touchend"===c.triggerOn&&r(i,o),t.extend(i,{startPoint:null,startDate:null,movePoint:null,moveDate:null,lastMovePoint:null,lastMoveDate:null,swiped:!1,swipeExecuted:!1});break;case"pinch":t.extend(i,{startPoint:null,startDistance:0,currentPoint:null,pinched:!1,scale:1,previousScale:null});break;case"longpress":clearTimeout(i.timer),t.extend(i,{startDate:null});break;case"rotate":var g=i.lastDegrees?i.degrees-i.lastDegrees:0;o.trigger("touchy-rotate",["end",o,{startPoint:i.startPoint,startDate:i.startDate,movePoint:i.movePoint,lastMovePoint:i.lastMovePoint,degrees:i.degrees,degreeDelta:g,velocity:i.velocity}]),t.extend(i,{startPoint:null,startDate:null,movePoint:null,moveDate:null,lastMovePoint:null,lastMoveDate:null,targetPageCoords:null,centerCoords:null,degrees:null,lastDegrees:null,velocity:null})}}}},a=function(e,a,o){n(e,a,o);var r=e.moveDate||e.startDate,s=o;e.held||s-r>e.settings.msHoldThresh?t.extend(e,{held:!0,lastMoveDate:r,lastMovePoint:e.movePoint&&e.movePoint.x?e.movePoint:e.startPoint,moveDate:s,movePoint:{x:a[0].pageX,y:a[0].pageY}}):t.extend(e,{held:!1,lastMoveDate:0,lastMovePoint:e.startPoint,moveDate:0,movePoint:e.startPoint})},o=function(e,a,o){n(e,a,o);var r=e.settings,s=(e.startDate,e.startPoint),i=e.moveDate||e.startDate,l=o,c={x:a[0].pageX,y:a[0].pageY},u=c.x-s.x,v=c.y-s.y,h=l-i;t.extend(e,{lastMoveDate:i,lastMovePoint:e.movePoint&&e.movePoint.x?e.movePoint:e.startPoint,moveDate:l,movePoint:c,hDistance:u,vDistance:v}),!e.swiped&&(Math.abs(u)/h>r.velocityThresh||Math.abs(v)/h>r.velocityThresh)&&(e.swiped=!0)},r=function(t,e){var a,o=t.movePoint,r=t.lastMovePoint,n=o.x===r.x&&o.y===r.y?0:Math.sqrt(Math.pow(o.x-r.x,2)+Math.pow(o.y-r.y,2)),s=t.moveDate-t.lastMoveDate,i=0===s?0:n/s,l=t.hDistance,c=t.vDistance;i>t.settings.velocityThresh&&(a=Math.abs(l)>Math.abs(c)?l>0?"right":"left":c>0?"down":"up",e.trigger("touchy-swipe",[e,{direction:a,movePoint:o,lastMovePoint:r,startPoint:t.startPoint,velocity:i}]))},n=function(t,e,a){t.startPoint||(t.startPoint={x:e[0].pageX,y:e[0].pageY}),t.startDate||(t.startDate=a)},s=function(){return"object"==typeof window.ongesturechange},i=function(t){var e=!1,a=t.originalEvent.touches;return 2===a.length?(e={x1:a[0].pageX,y1:a[0].pageY,x2:a[1].pageX,y2:a[1].pageY},e.centerX=(e.x1+e.x2)/2,e.centerY=(e.y1+e.y2)/2,e):e},l=function(e,a){var o,r=!1,n=0,s=u[a].length;if(t.touchyOptions.useDelegation){for(;s>n;n+=1)if(o=t(u[a][n]).has(e.target),o.length>0){r=o;break}}else u[a]&&-1!=u[a].index(e.target)&&(r=t(e.target));return r},c=function(t,e){function a(t,o,r){var n=t.offsetParent;if(o.x+=t.offsetLeft-(n?n.scrollLeft:0),o.y+=t.offsetTop-(n?n.scrollTop:0),n){if(1==n.nodeType){var s=r.getComputedStyle(n,"");if("static"!=s.position){if(o.x+=parseInt(s.borderLeftWidth),o.y+=parseInt(s.borderTopWidth),"TABLE"==n.localName)o.x+=parseInt(s.paddingLeft),o.y+=parseInt(s.paddingTop);else if("BODY"==n.localName){var i=r.getComputedStyle(t,"");o.x+=parseInt(i.marginLeft),o.y+=parseInt(i.marginTop)}}else"BODY"==n.localName&&(o.x+=parseInt(s.borderLeftWidth),o.y+=parseInt(s.borderTopWidth));for(var l=t.parentNode;n!=l;)o.x-=l.scrollLeft,o.y-=l.scrollTop,l=l.parentNode;a(n,o,r)}}else{if("BODY"==t.localName){var i=r.getComputedStyle(t,"");o.x+=parseInt(i.borderLeftWidth),o.y+=parseInt(i.borderTopWidth);var c=r.getComputedStyle(t.parentNode,"");o.x-=parseInt(c.paddingLeft),o.y-=parseInt(c.paddingTop)}t.scrollLeft&&(o.x+=t.scrollLeft),t.scrollTop&&(o.y+=t.scrollTop);var u=t.ownerDocument.defaultView;u&&!e&&u.frameElement&&a(u.frameElement,o,u)}}var o={x:0,y:0};return t&&a(t,o,t.ownerDocument.defaultView),o},u={},v={};t.each(t.touchyOptions,function(a,o){if("useDelegation"!==a){var r=a.charAt(0).toUpperCase()+a.slice(1);u[a]=t([]),v[a]=new function(){this.context=a},t.event.special["touchy-"+a]={setup:function(o,n,s){u[a]=u[a].add(this),t(this).data("touchy"+r,t.extend({},t.touchyOptions[a].data)),t(this).data("touchy"+r).settings=t.extend({},t.touchyOptions[a]),delete t(this).data("touchy"+r).settings.data,1===u[a].length&&t.each(t.touchyOptions[a].proxyEvents,function(o,r){t(document).bind(r.toLowerCase()+".touchy."+a,t.proxy(e["handle"+r],v[a]))})},teardown:function(e){u[a]=u[a].not(this),t(this).removeData("touchy"+r),0===u[a].length&&t.each(t.touchyOptions[a].proxyEvents,function(e,o){t(document).unbind(o.toLowerCase()+".touchy."+a)})},add:function(e){t.extend(t(this).data("touchy"+r).settings,e.data);var a=e.handler;e.handler=function(t){return a.apply(this,arguments)}}}}})}(jQuery);