<!DOCTYPE html> <html> <head> <meta charset=utf-8> <meta content='IE=edge,chrome=1' http-equiv=X-UA-Compatible> <!--[if (lt IE 9)&(!IEMobile)]><script src="/javascripts/html5.js?1620110901"></script><![endif]--> <meta content='width=device-width, initial-scale=1.0' name=viewport> <title>RailsCast 笔记【不完整】</title> <link href="/stylesheets/site.css?1620110901" rel=stylesheet /> <link href="/stylesheets/blog.css?1620110901" rel=stylesheet /> <link href="/stylesheets/highlight/railscasts.css?1620110901" rel=stylesheet /> <!--[if lt IE 9]><script src="/javascripts/respond.js?1620110901"></script><![endif]--> </head> <body class=''> <div id=container> <div id=main role=main> <aside class=sidebar> <nav> <span> <a href='/tech/'>home</a> </span> <span> <a href='/tech/calendar.html'>calendar</a> </span> <span> <a href='/tech/tags.html'>tags</a> </span> </nav> </aside> <div class=content> <header> <div class=article_nav> <span class=later> <a href='/tech/2009/04/14/move-to-javaeye.html'> < 更新 </a> </span> <span class=earlier> <a href='/tech/2009/01/18/high-performance-web.html'> 更早 > </a> </span> </div> <h1> RailsCast 笔记【不完整】 </h1> </header> <article class=markdown-body> <p>走过了弯路，看过了那些粗制滥造、过时、或者至少不够有深度的书之后，才知道：Ruby for Rails+The Ruby Programming Language+Agile Web Development with Rails+RailsCast这一个套装，才是学习Ruby on Rails最快最好的途径。其中RailsCast是免费的视频，目前已有152集。它的最大价值是让你直观地感觉到Rails中隐藏的力量。如果你整个 系列走下来，当你遇到一个问题时，你知道在Rails中大约可以以什么方式做到。当你心中有了明确的方向，只需要手持API Reference Manual，就可以解决一路上的问题。</p> <p>寒假到现在用Ruby on Rails为导师完成了一个小型教学网站，主要有课程管理、博客发表、课件上传下载、作业布置和上交以及留言系统。以后可能再在这里添加一份完整的功能介 绍吧。这个网站倾注了我大量的心血，解决了无数稀奇古怪的bug，对网站也做了许多次重构，实现了许多细小的功能，经过这番历练，我终于对基于MVC的网 站开发有了一个较为全局的认识，对Rails也非常熟悉了，也部分实践了我在《Web 2.0网站开发心得》中对Ajax的适度使用的原则。遗憾的是，由于时间的缘故，我无法把所有我想实现的特性都实现，项目已经需要投入实际使用当中了。希 望它在性能和稳定性方面能够不让人失望吧。以后再添加一个尚未全部实现的特性列表到这里吧。如果有时间，我想把整个网站在Ruby 1.9 on Rails 2.3下用BDD的方式重新开发一次，对网站整体做更大的重构，同时完整地使用Git来进行版本管理，同时借助于自己计划编写的GitRoller来制作 一系列视频。</p> <p>主要使用的技术：</p> <p>Ruby 1.8.6 on Rails 2.2 . Most of the ideas are inspired by Rails Cast</p> <p>Rails plugins or gems used:</p> <ul> <li>jRails</li> <li>will_paginate</li> <li>paperclip</li> <li>mimetype-fu</li> <li>populator</li> <li>faker</li> <li>JavaScript Library Used:</li> <li>jQuery</li> <li>TinyMCE</li> <li>TableSorter</li> <li>jCalendar</li> </ul> <p>Layout based on YAML . Some CSS are stolen from WebCredible and Firefox<br> Plugins(Germany).</p> <p>以下列表基于时间倒序整理。</p> <h2>新特性介绍</h2> <ul> <li> <ol start=152> <li>Rails 2.3 Extras</li> </ol> </li> <li> <ol start=151> <li>Rack Middleware</li> </ol> </li> <li> <ol start=150> <li>Rails Metal</li> </ol> </li> <li> <ol start=149> <li>Rails Engines</li> </ol> </li> <li> <ol start=148> <li>App Templates in Rails 2.3</li> </ol> </li> <li> <ol start=140> <li>Rails 2.2 Extras</li> </ol> </li> </ul> <h2>JavaScript 、Ajax</h2> <ul> <li> <ol start=147> <li>Sortable Lists</li> </ol> </li> <li> <ol start=136> <li>jQuery</li> </ol> </li> <li> <ol start=114> <li>Endless Page</li> </ol> </li> <li> <ol start=103> <li>Site Wide Announcements</li> </ol> </li> <li> <ol start=88> <li>Dynamic Select Menus</li> </ol> </li> <li> <ol start=45> <li>RJS Tips</li> </ol> </li> <li> <ol start=44> <li>Debugging RJS</li> </ol> </li> <li> <ol start=43> <li>AJAX with RJS</li> </ol> </li> </ul> <h2>电子商务</h2> <ul> <li> <ol start=146> <li>PayPal Express Checkout</li> </ol> </li> <li> <ol start=145> <li>Integrating Active Merchant</li> </ol> </li> <li> <ol start=144> <li>Active Merchant Basics</li> </ol> </li> <li> <ol start=143> <li>PayPal Security</li> </ol> </li> <li> <ol start=142> <li>PayPal Notifications</li> </ol> </li> <li> <ol start=141> <li>PayPal Basics</li> </ol> </li> </ul> <h2>Git 、Contribute</h2> <ul> <li> <ol start=113> <li>Contributing to Rails with Git</li> </ol> </li> <li> <ol start=105> <li>Gitting Rails 2.1 RC1</li> </ol> </li> <li> <ol start=96> <li>Git on Rails</li> </ol> </li> <li> <ol start=50> <li>Contributing to Rails</li> </ol> </li> <li> <ol start=36> <li>Subversion on Rails</li> </ol> </li> </ul> <h2>DIY</h2> <ul> <li> <ol start=135> <li>Making a Gem：制作一个Gem。你对Rails的扩充，只要符合一定的文件布局，就能又可以当插件用，又可以当gem用。</li> </ol> </li> <li> <ol start=33> <li>Making a Plugin：制作插件的方法。define_method、read_attribute、instance_variable_set等等。</li> </ol> </li> <li> <ol start=62> <li>Hacking ActiveRecord：如何为ActiveRecord增加方法。</li> </ol> </li> <li> <ol start=58> <li>How to Make a Generator：做一个自己的Generator。本质：erb。</li> </ol> </li> </ul> <h2>分页、预览、搜索、附件</h2> <ul> <li> <ol start=120> <li>Thinking Sphinx：全文搜索</li> </ol> </li> <li> <ol start=111> <li>Advanced Search Form：多个条件综合搜索。本质：动态merge hash。</li> </ol> </li> <li> <ol start=37> <li>Simple Search Form：单一条件搜索。本质：SQL之LIKE。</li> </ol> </li> <li> <ol start=38> <li>Multibutton Form：预览功能。本质：在同一个action中根据params的不同而展现不同的行为。</li> </ol> </li> <li> <ol start=51> <li>will_paginate：分页。</li> </ol> </li> <li> <ol start=134> <li>Paperclip：DSL风格轻松附件上传、验证、缩略图生成。我探索了的高级用法：任意多个附件、附件重命名等。</li> </ol> </li> </ul> <h2>部署</h2> <ul> <li> <ol start=133> <li>Capistrano Tasks</li> </ol> </li> <li> <ol start=123> <li>Subdomains</li> </ol> </li> <li> <ol start=122> <li>Passenger in Development</li> </ol> </li> </ul> <h2>REST 、路由</h2> <ul> <li> <ol start=34> <li>Named Routes：有名路由。例如对于:controller =&gt; :users, :action =&gt; new，可以命名为login，这样url就是/login了，一种美化。</li> </ol> </li> <li> <ol start=79> <li>Generate Named Routes：对map做send，动态生成named route，防止重名。</li> </ol> </li> <li> <ol start=63> <li>Model Name in URL：让url中可以包含有意义的信息，而不只是id。</li> </ol> </li> <li> <ol start=70> <li>Custom Routes：让url中可以包含多个参数作为路径，如2007/01/08。本质：":year/:month/:day"。</li> </ol> </li> <li> <ol start=46> <li>Catch-all Route：让url中此后的全部路径成为一个数组。例如对于"/*path"，"/a/b/c"的params[:path]就是['a','b','c']。</li> </ol> </li> <li> <ol start=35> <li>Custom REST Actions</li> </ol> </li> <li> <ol start=139> <li>Nested Resources</li> </ol> </li> <li> <ol start=95> <li>More on ActiveResource</li> </ol> </li> <li> <ol start=94> <li>ActiveResource Basics</li> </ol> </li> <li> <ol start=92> <li>make_resourceful</li> </ol> </li> <li> <ol start=117> <li>Semi-Static Pages</li> </ol> </li> </ul> <h2>控制器</h2> <ul> <li> <ol start=131> <li>Going Back：重定向到用户之前浏览的页面。</li> </ol> </li> <li> <ol start=87> <li>Generating RSS Feeds：创建RSS。</li> </ol> </li> <li> <ol start=78> <li>Generating PDF Documents：创建PDF。</li> </ol> </li> <li> <ol start=77> <li>Destroy Without JavaScript：在没有javaScript的情况下，如何让用户确认删除。</li> </ol> </li> </ul> <h2>用户、Session 、Authentication相关</h2> <ul> <li> <ol start=84> <li>Cookie Based Session Store： 没什么意思。讨论了一下session的存储机制。</li> </ol> </li> <li> <ol start=19> <li>Where Administration Goes： 管理员与普通用户共享一个界面。额外收获：action_model_path(var_model)。</li> </ol> </li> <li> <ol start=20> <li>Restricting Access： 根据是否管理员显隐一些部分，以及阻止一些action的perform。helper_method :admin?、before_filter :authorize, :except =&gt; :index。</li> </ol> </li> <li> <ol start=21> <li>Super Simple Authentication： 管理员的简单认证。通过session等各种方式判断是否管理员。session的创建与销毁。</li> </ol> </li> <li> <ol start=67> <li>restful_authentication： 介绍了restful_authenticate这个插件，非常好用的多用户管理。</li> </ol> </li> <li> <ol start=68> <li>OpenID Authentication： 基于OpenID的认证。</li> </ol> </li> <li> <ol start=82> <li>HTTP Basic Authentication： 内嵌在http协议中的基于用户名和密码的简单认证。2.3现在实现了HTTP Digest Authentication，保密程度更高。</li> </ol> </li> <li> <ol start=119> <li>Session Based Model： 可以让非注册用户在发表留言后一定时间内仍然可以回来修改留言。</li> </ol> </li> <li> <ol start=65> <li>Stopping Spam with Akismet： 阻止垃圾留言。</li> </ol> </li> <li> <ol start=61> <li>Sending Email： 发送邮件。</li> </ol> </li> <li> <ol start=124> <li>Beta Invitations： 邀请系统。</li> </ol> </li> </ul> <h2>视图</h2> <ul> <li> <ol start=132> <li>Helpers Outside Views</li> </ol> </li> <li> <ol start=125> <li>Dynamic Layouts</li> </ol> </li> <li> <ol start=118> <li>Liquid</li> </ol> </li> <li> <ol start=100> <li>5 View Tips</li> </ol> </li> <li> <ol start=69> <li>Markaby in Helper</li> </ol> </li> <li> <ol start=64> <li>Custom Helper Modules</li> </ol> </li> <li> <ol start=40> <li>Blocks in View</li> </ol> </li> <li> <ol start=32> <li>Time in Text Field</li> </ol> </li> <li> <ol start=31> <li>Formatting Time</li> </ol> </li> <li> <ol start=30> <li>Pretty Page Title</li> </ol> </li> <li> <ol start=18> <li>Looping Through Flash</li> </ol> </li> <li> <ol start=8> <li>Layouts and content_for</li> </ol> </li> <li> <ol start=7> <li>All About Layouts</li> </ol> </li> </ul> <h2>重构</h2> <ul> <li> <ol start=91> <li>Refactoring Long Methods</li> </ol> </li> <li> <ol start=75> <li>Complex Forms Part 3</li> </ol> </li> <li> <ol start=74> <li>Complex Forms Part 2</li> </ol> </li> <li> <ol start=73> <li>Complex Forms Part 1</li> </ol> </li> <li> <ol start=101> <li>Refactoring Out Helper Object</li> </ol> </li> <li> <ol start=12> <li>Refactoring User Name Part 3</li> </ol> </li> <li> <ol start=11> <li>Refactoring User Name Part 2</li> </ol> </li> <li> <ol start=10> <li>Refactoring User Name Part 1</li> </ol> </li> <li> <ol start=80> <li>Simplify Views with Rails 2.0</li> </ol> </li> <li> <ol start=55> <li>Cleaning Up the View</li> </ol> </li> <li> <ol start=99> <li>Complex Partials</li> </ol> </li> </ul> <h2>后台Rake</h2> <ul> <li> <ol start=66> <li>Custom Rake Tasks：如何写Rake任务。</li> </ol> </li> <li> <ol start=127> <li>Rake in Background：在后台运行Rake来执行耗时任务。</li> </ol> </li> <li> <ol start=128> <li>Starling and Workling：通过Rake的后台队列来异步执行Rakes。</li> </ol> </li> <li> <ol start=129> <li>Custom Daemon ：后台的daemon。和128的区别就像cron和at的区别。</li> </ol> </li> <li> <ol start=130> <li>Monitoring with God：监视daemon。</li> </ol> </li> </ul> <h2>模型、数据库层</h2> <ul> <li> <ol start=126> <li>Populating a Database</li> </ol> </li> <li> <ol start=109> <li>Tracking Attribute Changes</li> </ol> </li> <li> <ol start=121> <li>Non Active Record Model</li> </ol> </li> <li> <ol start=112> <li>Anonymous Scopes</li> </ol> </li> <li> <ol start=108> <li>named_scope</li> </ol> </li> <li> <ol start=107> <li>Migrations in Rails 2.1</li> </ol> </li> <li> <ol start=83> <li>Migrations in Rails 2.0</li> </ol> </li> <li> <ol start=16> <li>Virtual Attributes</li> </ol> </li> <li> <ol start=15> <li>Fun with Find Conditions</li> </ol> </li> <li> <ol start=14> <li>Performing Calculations on Models</li> </ol> </li> <li> <ol start=4> <li>Move Find into Model</li> </ol> </li> <li> <ol start=3> <li>Find Through Association</li> </ol> </li> <li> <ol start=2> <li>Dynamic find_by Methods</li> </ol> </li> <li> <ol start=59> <li>Optimistic Locking</li> </ol> </li> <li> <ol start=41> <li>Conditional Validations</li> </ol> </li> </ul> <h2>关联</h2> <ul> <li> <ol start=52> <li>Update through Checkboxes：一对多。通过checkbox来更新关联的items。"item_ids[]"。</li> </ol> </li> <li> <ol start=57> <li>Create Model Through Text Field ：一对多。Choose_or_create。collection_select。</li> </ol> </li> <li> <ol start=102> <li>Auto-Complete Association：一对多。Find_or_create_by。自动完成。</li> </ol> </li> <li> <ol start=17> <li>HABTM Checkboxes：多对多。产品与Catagory。</li> </ol> </li> <li> <ol start=47> <li>Two Many-to-Many：多态的多对多。</li> </ol> </li> </ul> <h2>Scope 、group</h2> <ul> <li> <ol start=76> <li>scope_out</li> </ol> </li> <li> <ol start=42> <li>with_options</li> </ol> </li> <li> <ol start=5> <li>Using with_scope</li> </ol> </li> <li> <ol start=29> <li>group_by Month</li> </ol> </li> <li> <ol start=28> <li>in_groups_of</li> </ol> </li> <li> <ol start=6> <li>Shortcut Blocks with Symbol to_proc</li> </ol> </li> </ul> <h2>性能</h2> <ul> <li> <ol> <li>Caching with Instance Variables： 用||=的方式缓存查询结果。</li> </ol> </li> <li> <ol start=115> <li>Caching in Rails 2.1： 用fectch cache的方式缓存结果。</li> </ol> </li> <li> <ol start=137> <li>Memoization： 用memorize的方式缓存结果。</li> </ol> </li> <li> <ol start=89> <li>Page Caching： 缓存页面。caches_page。如何用sweeper来清除过期页面。expire_page。</li> </ol> </li> <li> <ol start=93> <li>Action Caching： 缓存动作。</li> </ol> </li> <li> <ol start=90> <li>Fragment Caching： 缓存一个partial、或者说片段。</li> </ol> </li> <li> <ol start=98> <li>Request Profiling： 如何测试网站的性能瓶颈。</li> </ol> </li> <li> <ol start=97> <li>Analyzing the Production Log： 分析生产状态下运行的网站的日志查找网站的性能瓶颈。</li> </ol> </li> <li> <ol start=23> <li>Counter Cache Column： 例如，缓存博客拥有的评论数目。这样显示博客目录时，不必为每一个博客COUNT一次评论数目。</li> </ol> </li> <li> <ol start=22> <li>Eager Loading： 例如，一个课程拥有多个课件，如果find时使用了:include =&gt; :课件, :select =&gt; 'id, title'，显示课程目录时，也可以同时读取相关课件的标题信息。用于减少一个页面发起SQL查询的数目。</li> </ol> </li> </ul> <h2>Log 、调试</h2> <ul> <li> <ol start=24> <li>The Stack Trace： 如何理解堆栈追溯。</li> </ol> </li> <li> <ol start=9> <li>Filtering Sensitive Logs： 在日志中过滤掉敏感信息。</li> </ol> </li> <li> <ol start=104> <li>Exception Notifications： 当网站发生问题，发个邮件给管理员。exception_notifier和exception_logger。</li> </ol> </li> <li> <ol start=86> <li>Logging Variables： 如何在日志中输出变量的值。eval(..., binding)。</li> </ol> </li> <li> <ol start=56> <li>The Logger： 如何自定义和查看日志。</li> </ol> </li> <li> <ol start=54> <li>Debugging with ruby-debug： 如何调试Ruby。</li> </ol> </li> <li> <ol start=53> <li>Handling Exceptions： 用ruby的异常机制处理异常。</li> </ol> </li> <li> <ol start=49> <li>Reading the API： 比较好用的Rails文档</li> </ol> </li> <li> <ol start=48> <li>Console Tricks： 使用控制台script/console的技巧。</li> </ol> </li> </ul> <h2>测试</h2> <ul> <li> <ol start=116> <li>Selenium</li> </ol> </li> <li> <ol start=81> <li>Fixtures in Rails 2.0</li> </ol> </li> <li> <ol start=71> <li>Testing Controllers with RSpec</li> </ol> </li> <li> <ol start=60> <li>Testing without Fixtures</li> </ol> </li> </ul> <h2>设置</h2> <ul> <li> <ol start=85> <li>YAML Configuration File： 如何读取自己的YAML配置文件。我尝试了的高级使用：根据用户设置生成YAML配置，保证网站重启后用户的设置仍然有效。</li> </ol> </li> <li> <ol start=72> <li>Adding an Environment： 除了通常的development、production、test三种网站运行环境之外，添加一个staging环境用于演示。</li> </ol> </li> <li> <ol start=138> <li>I18n： 国际化。</li> </ol> </li> <li> <ol start=106> <li>Time Zones in Rails 2.1： 设置时区。或让用户自己指定时区。</li> </ol> </li> <li> <ol start=39> <li>Customize Field Error： 自定义当表单提交验证失败时显示错误信息的方式。</li> </ol> </li> <li> <ol start=110> <li>Gem Dependencies： 通过config.gem指定网站依赖的gem，对其存在进行验证，并可通过rake gems:install安装所需的gem。方便部署。</li> </ol> </li> </ul> <h2>安全</h2> <ul> <li> <ol start=27> <li>Cross Site Scripting： 如何使用h函数和sanitize函数来消除用户提交内容中带来安全风险的javascript脚本。</li> </ol> </li> <li> <ol start=26> <li>Hackers Love Mass Assignment： 通过attr_protected和attr_accessible防止黑客可以给某些字段赋值。</li> </ol> </li> <li> <ol start=25> <li>SQL Injection： 通过使用?来防止SQL注入式的攻击。</li> </ol> </li> <li> <ol start=13> <li>Dangers of Model in Session： 千万不要把模型保存在session里面。</li> </ol> </li> </ul> <section class=meta> <p> <span class=author> <a href='/'>宋皿</a> </span> <span class=time> <time datetime='2009-03-14 00:00:00 +0800'> 2009-03-14 </time> </span> </p> <p> <span class=license> Published under <a href='http://creativecommons.org/licenses/by-nc-nd/3.0/' rel=license>(CC) BY-NC-ND</a> </span> <span class=tags> tagged with <a href='/tech/tags.html#tag-ruby'> ruby </a> <a href='/tech/tags.html#tag-自学记录'> 自学记录 </a> </span> </p> </section> <div id=disqus_thread></div> <script>
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'utensil-at-github'; // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script> <a class=dsq-brlink href='http://disqus.com'> comments powered by <span class=logo-disqus>Disqus</span> </a> </article> </div> </div> </div> <script src="/javascripts/jquery-1.7.1.js?1620110901"></script> <script src="/javascripts/highlight.pack.js?1620110901"></script> <script>
  hljs.initHighlightingOnLoad();
  // $(document).ready(function() {
  //   $('pre code').each(function(i, e) {hljs.highlightBlock(e)});
  // });
</script> <script>
  // (function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"===e.location.protocol?"https:":"http:")+'//cdn.mxpnl.com/libs/mixpanel-2.2.min.js';f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f);b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!== typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");for(g=0;g<i.length;g++)f(c,i[g]); b._i.push([a,e,d])};b.__SV=1.2}})(document,window.mixpanel||[]); mixpanel.init("eda89891866a7e90b6699df21e79ea61");
  // mixpanel.track("visit");
</script> </body> </html>